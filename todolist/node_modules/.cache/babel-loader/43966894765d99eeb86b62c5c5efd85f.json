{"ast":null,"code":"import _possibleConstructorReturn from \"/Users/lijunshuang/Documents/GitHub/Mobx/todolist/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/lijunshuang/Documents/GitHub/Mobx/todolist/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/lijunshuang/Documents/GitHub/Mobx/todolist/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _initializerDefineProperty from \"/Users/lijunshuang/Documents/GitHub/Mobx/todolist/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty\";\nimport _classCallCheck from \"/Users/lijunshuang/Documents/GitHub/Mobx/todolist/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/lijunshuang/Documents/GitHub/Mobx/todolist/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _applyDecoratedDescriptor from \"/Users/lijunshuang/Documents/GitHub/Mobx/todolist/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\nimport _initializerWarningHelper from \"/Users/lijunshuang/Documents/GitHub/Mobx/todolist/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper\";\n\nvar _dec,\n    _class,\n    _descriptor,\n    _descriptor2,\n    _descriptor3,\n    _temp,\n    _dec2,\n    _dec3,\n    _class3,\n    _descriptor4,\n    _temp2,\n    _class5,\n    _class6,\n    _temp3,\n    _jsxFileName = \"/Users/lijunshuang/Documents/GitHub/Mobx/todolist/src/component/TodoListTwo.jsx\",\n    _class7,\n    _class8,\n    _temp4;\n\nimport React, { Component, Fragment } from \"react\";\nimport { observe, observable, action, computed } from 'mobx';\nimport PropTypes from 'prop-types';\nimport { observer, PropTypes as ObservablePropTypes } from 'mobx-react';\nimport \"../App.scss\";\nvar Todo = (_dec = action.bound, (_class = (_temp =\n/*#__PURE__*/\nfunction () {\n  function Todo(title) {\n    _classCallCheck(this, Todo);\n\n    _initializerDefineProperty(this, \"id\", _descriptor, this);\n\n    _initializerDefineProperty(this, \"title\", _descriptor2, this);\n\n    _initializerDefineProperty(this, \"finished\", _descriptor3, this);\n\n    this.title = title;\n  }\n\n  _createClass(Todo, [{\n    key: \"finishedToggle\",\n    value: function finishedToggle() {\n      this.finished = !this.finished;\n    }\n  }]);\n\n  return Todo;\n}(), _temp), (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"id\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return Math.random();\n  }\n}), _descriptor2 = _applyDecoratedDescriptor(_class.prototype, \"title\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return \"\";\n  }\n}), _descriptor3 = _applyDecoratedDescriptor(_class.prototype, \"finished\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"finishedToggle\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"finishedToggle\"), _class.prototype)), _class));\nvar Store = (_dec2 = action.bound, _dec3 = action.bound, (_class3 = (_temp2 =\n/*#__PURE__*/\nfunction () {\n  function Store() {\n    var _this = this;\n\n    _classCallCheck(this, Store);\n\n    _initializerDefineProperty(this, \"todos\", _descriptor4, this);\n\n    this.disposers = [];\n    // observe 返回的是一个disposers\n    observe(this.todos, function (change) {\n      _this.disposers.forEach(function (disposer) {\n        return disposer();\n      }); //解除监控\n\n\n      _this.disposers = []; //清空disposers数组\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = change.object[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var todo = _step.value;\n          observe(todo); //使用observe 来监视todo\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      console.log(change);\n    });\n  }\n\n  _createClass(Store, [{\n    key: \"addTodo\",\n    value: function addTodo(title) {\n      this.todos.unshift(new Todo(title));\n    }\n  }, {\n    key: \"removeTodo\",\n    value: function removeTodo(todo) {\n      //remove非数组自带方法，是mobx-react提供的\n      this.todos.remove(todo);\n    } // 计算属性\n\n  }, {\n    key: \"unfinished\",\n    get: function get() {\n      return this.todos.filter(function (todo) {\n        return !todo.finished;\n      }).length;\n    }\n  }]);\n\n  return Store;\n}(), _temp2), (_descriptor4 = _applyDecoratedDescriptor(_class3.prototype, \"todos\", [observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _applyDecoratedDescriptor(_class3.prototype, \"addTodo\", [_dec2], Object.getOwnPropertyDescriptor(_class3.prototype, \"addTodo\"), _class3.prototype), _applyDecoratedDescriptor(_class3.prototype, \"removeTodo\", [_dec3], Object.getOwnPropertyDescriptor(_class3.prototype, \"removeTodo\"), _class3.prototype), _applyDecoratedDescriptor(_class3.prototype, \"unfinished\", [computed], Object.getOwnPropertyDescriptor(_class3.prototype, \"unfinished\"), _class3.prototype)), _class3));\nvar store = new Store();\n\nvar TodoItem = observer(_class5 = (_temp3 = _class6 =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TodoItem, _Component);\n\n  function TodoItem() {\n    var _getPrototypeOf2;\n\n    var _this2;\n\n    _classCallCheck(this, TodoItem);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TodoItem)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this2.handleClick = function (e) {\n      _this2.props.todo.finishedToggle();\n    };\n\n    return _this2;\n  }\n\n  _createClass(TodoItem, [{\n    key: \"render\",\n    value: function render() {\n      var todo = this.props.todo;\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"checkbox\",\n        className: \"toggle\",\n        checked: todo.finished,\n        onChange: function onChange() {\n          return '';\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }), React.createElement(\"span\", {\n        className: ['title', todo.finished && 'finished'].join(' '),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, todo.title));\n    }\n  }]);\n\n  return TodoItem;\n}(Component), _class6.propTypes = {\n  // 传入todo\n  todo: PropTypes.shape({\n    id: PropTypes.number.isRequired,\n    title: PropTypes.string.isRequired,\n    finished: PropTypes.bool.isRequired,\n    finishedToggle: PropTypes.func\n  }).isRequired,\n  // 传入store\n  store: PropTypes.shape({\n    todos: PropTypes.array.isRequired\n  }).isRequired\n}, _temp3)) || _class5;\n\nvar TodoList = observer(_class7 = (_temp4 = _class8 =\n/*#__PURE__*/\nfunction (_Component2) {\n  _inherits(TodoList, _Component2);\n\n  function TodoList() {\n    var _getPrototypeOf3;\n\n    var _this3;\n\n    _classCallCheck(this, TodoList);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this3 = _possibleConstructorReturn(this, (_getPrototypeOf3 = _getPrototypeOf(TodoList)).call.apply(_getPrototypeOf3, [this].concat(args)));\n    _this3.state = {\n      inputVal: ''\n    };\n\n    _this3.handleSubmit = function (e) {\n      e.preventDefault();\n      var store = _this3.props.store;\n      var inputVal = _this3.state.inputVal; //如果inputVal的值不为空，去除首尾的空格，则向store中添加todos\n\n      if (inputVal.replace(/(^\\s*)|(\\s*$)/g, \"\")) {\n        store.addTodo(inputVal);\n      }\n\n      _this3.setState({\n        inputVal: ''\n      });\n    };\n\n    _this3.handleChange = function (e) {\n      var inputVal = e.target.value;\n\n      _this3.setState({\n        inputVal: inputVal\n      });\n    };\n\n    return _this3;\n  }\n\n  _createClass(TodoList, [{\n    key: \"render\",\n    value: function render() {\n      var store = this.props.store;\n      var todos = store.todos;\n      return React.createElement(\"div\", {\n        className: \"todo-list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"header\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        className: \"input\",\n        placeholder: \"What needs to finished ?\",\n        value: this.state.inputVal,\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }))), React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, todos.map(function (todo) {\n        return React.createElement(\"li\", {\n          key: todo.id,\n          onClick: function onClick() {\n            return todo.finishedToggle();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        }, React.createElement(TodoItem, {\n          todo: todo,\n          store: store,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }), React.createElement(\"span\", {\n          className: \"delete\",\n          onClick: function onClick(e) {\n            return store.removeTodo(todo);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }, \"X\"));\n      })), React.createElement(\"footer\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, \" \", store.unfinished, \" item(s) is unfinished !\"));\n    }\n  }]);\n\n  return TodoList;\n}(Component), _class8.propTypes = {\n  store: PropTypes.shape({\n    // 对store内的数据进行类型校验\n    addTodo: PropTypes.func,\n    // todos为observableArray，其内数据为observableObject，isRequire表示store、todos必须存在\n    todos: ObservablePropTypes.observableArrayOf(ObservablePropTypes.observableObject).isRequired\n  }).isRequired\n}, _temp4)) || _class7;\n\nvar App =\n/*#__PURE__*/\nfunction (_Component3) {\n  _inherits(App, _Component3);\n\n  function App() {\n    _classCallCheck(this, App);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(App).apply(this, arguments));\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(TodoList, {\n        store: store,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/lijunshuang/Documents/GitHub/Mobx/todolist/src/component/TodoListTwo.jsx"],"names":["React","Component","Fragment","observe","observable","action","computed","PropTypes","observer","ObservablePropTypes","Todo","bound","title","finished","Math","random","Store","disposers","todos","change","forEach","disposer","object","todo","console","log","unshift","remove","filter","length","store","TodoItem","handleClick","e","props","finishedToggle","join","propTypes","shape","id","number","isRequired","string","bool","func","array","TodoList","state","inputVal","handleSubmit","preventDefault","replace","addTodo","setState","handleChange","target","value","map","removeTodo","unfinished","observableArrayOf","observableObject","App"],"mappings":"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","sourcesContent":["import React, { Component, Fragment} from \"react\";\nimport { observe, observable, action, computed } from 'mobx'\nimport PropTypes from 'prop-types'\nimport { observer, PropTypes as ObservablePropTypes } from 'mobx-react'\n\nimport \"../App.scss\"\nclass Todo { \n  @observable id = Math.random();\n  @observable title = \"\"\n  @observable finished = false\n\n  constructor (title) {\n    this.title =  title;\n  }\n\n  @action.bound finishedToggle() {\n    this.finished = !this.finished;\n  }\n}\nclass Store { \n  @observable todos = [];\n\n  disposers = []\n\n  constructor() {\n    // observe 返回的是一个disposers\n    observe(this.todos, change => {\n      this.disposers.forEach(disposer => disposer());//解除监控\n      this.disposers = [];//清空disposers数组\n\n      for (let todo of change.object) {\n        observe(todo)//使用observe 来监视todo\n      }\n      \n      console.log(change);\n      \n    })\n  }\n\n  @action.bound addTodo(title) {    \n    this.todos.unshift(new Todo(title));\n  }\n  @action.bound removeTodo(todo) {    \n    //remove非数组自带方法，是mobx-react提供的\n    this.todos.remove(todo);\n  }\n  // 计算属性\n  @computed get unfinished() { \n    return this.todos.filter(todo=>!todo.finished).length\n  }\n}\n\nconst store = new Store()\n@observer\nclass TodoItem extends Component { \n  static propTypes = {\n    // 传入todo\n    todo: PropTypes.shape({\n      id: PropTypes.number.isRequired,\n      title: PropTypes.string.isRequired,\n      finished: PropTypes.bool.isRequired,\n      finishedToggle:PropTypes.func\n    }).isRequired,\n    // 传入store\n    store: PropTypes.shape({\n      todos: PropTypes.array.isRequired,\n    }).isRequired\n  }\n  handleClick = e => {\n    this.props.todo.finishedToggle()\n  }\n\n  render() {\n    const todo = this.props.todo\n    return (\n      <Fragment>\n        <input\n          type=\"checkbox\"\n          className=\"toggle\"\n          checked={todo.finished}\n          onChange={()=>''}\n        />\n        <span className={['title',todo.finished && 'finished'].join(' ')}>{todo.title}</span>\n      </Fragment>\n    )\n  }\n}\n@observer\nclass TodoList extends Component {\n  static propTypes = {\n    store: PropTypes.shape({\n      // 对store内的数据进行类型校验\n      addTodo: PropTypes.func,\n      // todos为observableArray，其内数据为observableObject，isRequire表示store、todos必须存在\n      todos: ObservablePropTypes.observableArrayOf(ObservablePropTypes.observableObject).isRequired\n    }).isRequired\n\n  }\n  state = {\n    inputVal :''\n  }\n\n  handleSubmit = (e) => {\n    e.preventDefault();\n    const store = this.props.store\n    const inputVal = this.state.inputVal\n    //如果inputVal的值不为空，去除首尾的空格，则向store中添加todos\n    if (inputVal.replace(/(^\\s*)|(\\s*$)/g,\"\")) { \n      store.addTodo(inputVal)\n    }\n    this.setState({\n      inputVal: ''\n    })\n\n  }\n  handleChange = (e) => { \n    const inputVal = e.target.value\n    this.setState({\n      inputVal\n    })\n  }\n  render() {\n    const store = this.props.store\n    const todos = store.todos\n    return (\n      <div className=\"todo-list\">\n        <header>\n          <form onSubmit={this.handleSubmit}>\n            <input\n              type=\"text\"\n              className=\"input\"\n              placeholder=\"What needs to finished ?\"\n              value={this.state.inputVal}\n              onChange={this.handleChange}\n            />\n          </form>\n        </header>\n        <ul>\n          {\n            todos.map(todo => <li key={todo.id} onClick={() => todo.finishedToggle()}>\n              <TodoItem todo={todo} store={store} />\n              <span className=\"delete\" onClick={e=>store.removeTodo(todo)}>X</span>\n            </li>)\n          }\n        </ul>\n        <footer> {store.unfinished} item(s) is unfinished !</footer>\n      </div>\n    )\n  }\n}\nclass App extends Component {\n  render() {\n    return <div>\n      <TodoList store={store} />\n    </div>;\n  }\n}\nexport default App"]},"metadata":{},"sourceType":"module"}